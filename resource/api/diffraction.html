
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>diffraction Module &#8212; scikit-beam 0.0.12.post8+g7aaf6ce documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.12.post8+g7aaf6ce',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="fluorescence Module" href="fluorescence.html" />
    <link rel="prev" title="core.mask Module" href="core/mask.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-skbeam.diffraction">
<span id="diffraction-module"></span><h1><code class="xref py py-mod docutils literal"><span class="pre">diffraction</span></code> Module<a class="headerlink" href="#module-skbeam.diffraction" title="Permalink to this headline">¶</a></h1>
<p>This module creates a namespace for X-Ray Diffraction</p>
<dl class="class">
<dt id="skbeam.diffraction.BasicElement">
<em class="property">class </em><code class="descclassname">skbeam.diffraction.</code><code class="descname">BasicElement</code><span class="sig-paren">(</span><em>Z</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.BasicElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.5/library/functions.html#object" title="(in Python v3.5)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Object to return basic elemental information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>element</strong> : str or int</p>
<blockquote class="last">
<div><p>Element symbol, name or atomic number (‘Zinc’, ‘Zn’ or 30)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create an `Element` object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;Zn&#39;</span><span class="p">)</span> <span class="c1"># or e = Element(30)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get the atomic mass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">mass</span>
<span class="go">65.37</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get the density in grams / cm^3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">density</span>
<span class="go">7.14</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Z</strong></td>
<td>(int) Atomic number</td>
</tr>
<tr class="row-even"><td><strong>sym</strong></td>
<td>(str) Element symbol (Fe, Cr, etc.)</td>
</tr>
<tr class="row-odd"><td><strong>name</strong></td>
<td>(str) Full element name (Iron, Chromium, etc.</td>
</tr>
<tr class="row-even"><td><strong>atomic_radius</strong></td>
<td>(float) AtomicRadius[A]</td>
</tr>
<tr class="row-odd"><td><strong>covalent_radius</strong></td>
<td>(float) CovalentRadius[A]</td>
</tr>
<tr class="row-even"><td><strong>mass</strong></td>
<td>(float) AtomicMass</td>
</tr>
<tr class="row-odd"><td><strong>bp</strong></td>
<td>(float) BoilingPoint[K]</td>
</tr>
<tr class="row-even"><td><strong>mp</strong></td>
<td>(float) MeltingPoint[K]</td>
</tr>
<tr class="row-odd"><td><strong>density</strong></td>
<td>(float) Density[g/ccm]</td>
</tr>
<tr class="row-even"><td><strong>atomic_volume</strong></td>
<td>(float) AtomicVolume</td>
</tr>
<tr class="row-odd"><td><strong>coherent_scattering_length</strong></td>
<td>(float) CoherentScatteringLength[1E-12cm]</td>
</tr>
<tr class="row-even"><td><strong>incoherent_crosssection</strong></td>
<td>(float) IncoherentX-section[barn]</td>
</tr>
<tr class="row-odd"><td><strong>absorption</strong></td>
<td>(float) Absorption&#64;1.8A[barn]</td>
</tr>
<tr class="row-even"><td><strong>debye_temp</strong></td>
<td>(float) DebyeTemperature[K]</td>
</tr>
<tr class="row-odd"><td><strong>thermal_conductivity</strong></td>
<td>(float) ThermalConductivity[W/cmK]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="skbeam.diffraction.Lorentzian2Model">
<em class="property">class </em><code class="descclassname">skbeam.diffraction.</code><code class="descname">Lorentzian2Model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.Lorentzian2Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">lmfit.model.Model</span></code></p>
<p>Wrap the lorentzian2 function for fitting within lmfit framework
1-d lorentzian squared profile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>independent variable</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of lorentzian squared peak,
If area is set as 1, the integral is unity.</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote class="last">
<div><p>standard deviation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.gaussian">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">gaussian</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>1 dimensional gaussian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>independent variable</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>Area of the normally distributed peak</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote class="last">
<div><p>standard deviation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.lorentzian">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">lorentzian</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>1 dimensional lorentzian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>independent variable</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of lorentzian peak,
If area is set as 1, the integral is unity.</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote class="last">
<div><p>standard deviation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.lorentzian2">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">lorentzian2</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.lorentzian2" title="Permalink to this definition">¶</a></dt>
<dd><p>1-d lorentzian squared profile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>independent variable</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of lorentzian squared peak,
If area is set as 1, the integral is unity.</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote class="last">
<div><p>standard deviation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.voigt">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">voigt</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>gamma=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolution of gaussian and lorentzian curve.</p>
<p>see <a class="reference external" href="http://en.wikipedia.org/wiki/Voigt_profile">http://en.wikipedia.org/wiki/Voigt_profile</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>independent variable</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of voigt peak</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote>
<div><p>standard deviation</p>
</div></blockquote>
<p><strong>gamma</strong> : float, optional</p>
<blockquote class="last">
<div><p>half width at half maximum of lorentzian.
If optional, <cite>gamma</cite> gets set to <cite>sigma</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.pvoigt">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">pvoigt</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>fraction</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.pvoigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear combination  of gaussian and lorentzian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>independent variable</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of pvoigt peak</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote>
<div><p>standard deviation</p>
</div></blockquote>
<p><strong>fraction</strong> : float</p>
<blockquote class="last">
<div><p>weight for lorentzian peak in the linear combination, and (1-fraction)
is the weight for gaussian peak.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.gaussian_tail">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">gaussian_tail</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.gaussian_tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a gaussian tail function to simulate compton peak</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>data in x coordinate</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of gauss tail function
If area is set as 1, the integral is unity.</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote>
<div><p>control peak width</p>
</div></blockquote>
<p><strong>gamma</strong> : float</p>
<blockquote>
<div><p>normalization factor</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>counts</strong> : array</p>
<blockquote class="last">
<div><p>gaussian tail peak</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r5154" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R5154]</a></td><td>Rene Van Grieken, “Handbook of X-Ray Spectrometry, Second Edition,
(Practical Spectroscopy)”, CRC Press, 2 edition, pp. 182, 2007.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.gausssian_step">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">gausssian_step</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>peak_e</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.gausssian_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Gauss step function is an important component in modeling compton peak.
Use scipy erfc function. Please note erfc = 1-erf.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>data in x coordinate</p>
</div></blockquote>
<p><strong>area</strong> : float</p>
<blockquote>
<div><p>area of gauss step function</p>
</div></blockquote>
<p><strong>center</strong> : float</p>
<blockquote>
<div><p>center position</p>
</div></blockquote>
<p><strong>sigma</strong> : float</p>
<blockquote>
<div><p>standard deviation</p>
</div></blockquote>
<p><strong>peak_e</strong> : float</p>
<blockquote>
<div><p>emission energy</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>counts</strong> : array</p>
<blockquote class="last">
<div><p>gaussian step peak</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r5255" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R5255]</a></td><td>Rene Van Grieken, “Handbook of X-Ray Spectrometry, Second Edition,
(Practical Spectroscopy)”, CRC Press, 2 edition, pp. 182, 2007.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.process_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">process_to_q</code><span class="sig-paren">(</span><em>setting_angles</em>, <em>detector_size</em>, <em>pixel_size</em>, <em>calibrated_center</em>, <em>dist_sample</em>, <em>wavelength</em>, <em>ub</em>, <em>frame_mode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.process_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>This will compute the hkl values for all pixels in a shape specified by
detector_size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>setting_angles</strong> : ndarray</p>
<blockquote>
<div><p>six angles of all the images - Required shape is [num_images][6] and
required type is something that can be cast to a 2D numpy array
Angle order: delta, theta, chi, phi, mu, gamma (degrees)</p>
</div></blockquote>
<p><strong>detector_size</strong> : tuple</p>
<blockquote>
<div><p>2 element tuple defining the number of pixels in the detector. Order is
(num_columns, num_rows)</p>
</div></blockquote>
<p><strong>pixel_size</strong> : tuple</p>
<blockquote>
<div><p>2 element tuple defining the size of each pixel in mm. Order is
(column_pixel_size, row_pixel_size).  If not in mm, must be in the same
units as <cite>dist_sample</cite></p>
</div></blockquote>
<p><strong>calibrated_center</strong> : tuple</p>
<blockquote>
<div><p>2 element tuple defining the center of the detector in pixels. Order
is (column_center, row_center)(x y)</p>
</div></blockquote>
<p><strong>dist_sample</strong> : float</p>
<blockquote>
<div><p>distance from the sample to the detector (mm). If not in mm, must be
in the same units as <cite>pixel_size</cite></p>
</div></blockquote>
<p><strong>wavelength</strong> : float</p>
<blockquote>
<div><p>wavelength of incident radiation (Angstroms)</p>
</div></blockquote>
<p><strong>ub</strong> : ndarray</p>
<blockquote>
<div><p>UB matrix (orientation matrix) 3x3 matrix</p>
</div></blockquote>
<p><strong>frame_mode</strong> : str, optional</p>
<blockquote>
<div><p>Frame mode defines the data collection mode and thus the desired
output from this function. Defaults to hkl mode (frame_mode=4)
‘theta’    : Theta axis frame.
‘phi’      : Phi axis frame.
‘cart’     : Crystal cartesian frame.
‘hkl’      : Reciprocal lattice units frame.
See the <cite>process_to_q.frame_mode</cite> attribute for an exact list of
valid options.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>hkl</strong> : ndarray</p>
<blockquote class="last">
<div><p>(Qx, Qy, Qz) - HKL values
shape is [num_images * num_rows * num_columns][3]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Six angles of an image: (delta, theta, chi, phi, mu, gamma )
These axes are defined according to the following references.</p>
<p>References: text <a class="reference internal" href="#r5356" id="id3">[R5356]</a>, text <a class="reference internal" href="#r5456" id="id4">[R5456]</a></p>
<table class="docutils citation" frame="void" id="r5356" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[R5356]</a></td><td>M. Lohmeier and E.Vlieg, “Angle calculations for a six-circle
surface x-ray diffractometer,” J. Appl. Cryst., vol 26, pp 706-716,
1993.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r5456" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[R5456]</a></td><td>E. Vlieg, “A (2+3)-Type surface diffractometer: Mergence of the
z-axis and (2+2)-Type geometries,” J. Appl. Cryst., vol 31, pp 198-203,
1998.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.hkl_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">hkl_to_q</code><span class="sig-paren">(</span><em>hkl_arr</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.hkl_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>This module compute the reciprocal space (q) values from known HKL array
for each pixel of the detector for all the images</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hkl_arr</strong> : ndarray</p>
<blockquote>
<div><p>(Qx, Qy, Qz) - HKL array
shape is [num_images * num_rows * num_columns][3]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>q_val</strong> : ndarray</p>
<blockquote class="last">
<div><p>Reciprocal values for each pixel for all images
shape is [num_images * num_rows * num_columns]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.bin_1D">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">bin_1D</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>nx=None</em>, <em>min_x=None</em>, <em>max_x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.bin_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin the values in y based on their x-coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>position</p>
</div></blockquote>
<p><strong>y</strong> : array</p>
<blockquote>
<div><p>intensity</p>
</div></blockquote>
<p><strong>nx</strong> : integer, optional</p>
<blockquote>
<div><p>number of bins to use defaults to default bin value</p>
</div></blockquote>
<p><strong>min_x</strong> : float, optional</p>
<blockquote>
<div><p>Left edge of first bin defaults to minimum value of x</p>
</div></blockquote>
<p><strong>max_x</strong> : float, optional</p>
<blockquote>
<div><p>Right edge of last bin defaults to maximum value of x</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>edges</strong> : array</p>
<blockquote>
<div><p>edges of bins, length nx + 1</p>
</div></blockquote>
<p><strong>val</strong> : array</p>
<blockquote>
<div><p>sum of values in each bin, length nx</p>
</div></blockquote>
<p><strong>count</strong> : array</p>
<blockquote class="last">
<div><p>The number of counts in each bin, length nx</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.bin_edges">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">bin_edges</code><span class="sig-paren">(</span><em>range_min=None</em>, <em>range_max=None</em>, <em>nbins=None</em>, <em>step=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.bin_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate bin edges.  The last value in the returned array is
the right edge of the last bin, the rest of the values are the
left edges of each bin.</p>
<p>If <cite>range_max</cite> is specified all bin edges will be less than or
equal to it’s value.</p>
<p>If <cite>range_min</cite> is specified all bin edges will be greater than
or equal to it’s value</p>
<p>If <cite>nbins</cite> is specified then there will be than number of bins and
the returned array will have length <cite>nbins + 1</cite> (as the right most
edge is included)</p>
<p>If <cite>step</cite> is specified then bin width is approximately <cite>step</cite> (It is
not exact due to the nature of floats). The arrays generated by
<cite>np.cumsum(np.ones(nbins) * step)</cite> and <cite>np.arange(nbins) * step</cite> are
not identical.  This function uses the second method in all cases
where <cite>step</cite> is specified.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the set <code class="code docutils literal"><span class="pre">(range_min,</span> <span class="pre">range_max,</span> <span class="pre">step)</span></code> is
given there is no guarantee that <code class="code docutils literal"><span class="pre">range_max</span> <span class="pre">-</span> <span class="pre">range_min</span></code>
is an integer multiple of <code class="code docutils literal"><span class="pre">step</span></code>.  In this case the left
most bin edge is <code class="code docutils literal"><span class="pre">range_min</span></code> and the right most bin edge
is less than <code class="code docutils literal"><span class="pre">range_max</span></code> and the distance between the
right most edge and <code class="code docutils literal"><span class="pre">range_max</span></code> is not greater than
<code class="code docutils literal"><span class="pre">step</span></code> (this is the same behavior as the built-in
<code class="code docutils literal"><span class="pre">range()</span></code>).  It is not recommended to specify bins in this
manner.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>range_min</strong> : float, optional</p>
<blockquote>
<div><p>The minimum value that may be included as a bin edge</p>
</div></blockquote>
<p><strong>range_max</strong> : float, optional</p>
<blockquote>
<div><p>The maximum value that may be included as a bin edge</p>
</div></blockquote>
<p><strong>nbins</strong> : int, optional</p>
<blockquote>
<div><p>The number of bins, if specified the length of the returned
value will be nbins + 1</p>
</div></blockquote>
<p><strong>step</strong> : float, optional</p>
<blockquote>
<div><p>The step between the bins</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>edges</strong> : np.array</p>
<blockquote class="last">
<div><p>An array of floats for the bin edges.  The last value is the
right edge of the last bin.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.bin_edges_to_centers">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">bin_edges_to_centers</code><span class="sig-paren">(</span><em>input_edges</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.bin_edges_to_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for turning a array of bin edges into
an array of bin centers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>input_edges</strong> : array-like</p>
<blockquote>
<div><p>N + 1 values which are the left edges of N bins
and the right edge of the last bin</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>centers</strong> : ndarray</p>
<blockquote class="last">
<div><p>A length N array giving the centers of the bins</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.grid3d">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">grid3d</code><span class="sig-paren">(</span><em>q</em>, <em>img_stack</em>, <em>nx=None</em>, <em>ny=None</em>, <em>nz=None</em>, <em>xmin=None</em>, <em>xmax=None</em>, <em>ymin=None</em>, <em>ymax=None</em>, <em>zmin=None</em>, <em>zmax=None</em>, <em>binary_mask=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.grid3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Grid irregularly spaced data points onto a regular grid via histogramming</p>
<p>This function will process the set of reciprocal space values (q), the
image stack (img_stack) and grid the image data based on the bounds
provided, using defaults if none are provided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : ndarray</p>
<blockquote>
<div><p>(Qx, Qy, Qz) - HKL values - Nx3 array</p>
</div></blockquote>
<p><strong>img_stack</strong> : ndarray</p>
<blockquote>
<div><p>Intensity array of the images
dimensions are: [num_img][num_rows][num_cols]</p>
</div></blockquote>
<p><strong>nx</strong> : int, optional</p>
<blockquote>
<div><p>Number of voxels along x</p>
</div></blockquote>
<p><strong>ny</strong> : int, optional</p>
<blockquote>
<div><p>Number of voxels along y</p>
</div></blockquote>
<p><strong>nz</strong> : int, optional</p>
<blockquote>
<div><p>Number of voxels along z</p>
</div></blockquote>
<p><strong>xmin</strong> : float, optional</p>
<blockquote>
<div><p>Minimum value along x. Defaults to smallest x value in q</p>
</div></blockquote>
<p><strong>ymin</strong> : float, optional</p>
<blockquote>
<div><p>Minimum value along y. Defaults to smallest y value in q</p>
</div></blockquote>
<p><strong>zmin</strong> : float, optional</p>
<blockquote>
<div><p>Minimum value along z. Defaults to smallest z value in q</p>
</div></blockquote>
<p><strong>xmax</strong> : float, optional</p>
<blockquote>
<div><p>Maximum value along x. Defaults to largest x value in q</p>
</div></blockquote>
<p><strong>ymax</strong> : float, optional</p>
<blockquote>
<div><p>Maximum value along y. Defaults to largest y value in q</p>
</div></blockquote>
<p><strong>zmax</strong> : float, optional</p>
<blockquote>
<div><p>Maximum value along z. Defaults to largest z value in q</p>
</div></blockquote>
<p><strong>binary_mask</strong> : ndarray, optional</p>
<blockquote>
<div><p>The binary mask provides a mechanism to remove unwanted pixels
from the images.
Binary mask can be two different shapes.
- 1: 2-D with binary_mask.shape == np.asarray(img_stack[0]).shape
- 2: 3-D with binary_mask.shape == np.asarray(img_stack).shape</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mean</strong> : ndarray</p>
<blockquote>
<div><p>intensity grid.  The values in this grid are the
mean of the values that fill with in the grid.</p>
</div></blockquote>
<p><strong>occupancy</strong> : ndarray</p>
<blockquote>
<div><p>The number of data points that fell in the grid.</p>
</div></blockquote>
<p><strong>std_err</strong> : ndarray</p>
<blockquote>
<div><p>This is the standard error of the value in the
grid box.</p>
</div></blockquote>
<p><strong>bounds</strong> : list</p>
<blockquote class="last">
<div><p>tuple of (min, max, step) for x, y, z in order: [x_bounds,
y_bounds, z_bounds]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.q_to_d">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">q_to_d</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.q_to_d" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert <span class="math">\(d\)</span> to <span class="math">\(q\)</span>.  The point
of this function is to prevent fat-fingered typos.</p>
<p>By definition the relationship is:</p>
<p>..math</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">2</span> \<span class="n">pi</span><span class="p">}{</span><span class="n">d</span><span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array</p>
<blockquote>
<div><p>An array of q values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>d</strong> : array</p>
<blockquote class="last">
<div><p>An array of d (plane) spacing</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.d_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">d_to_q</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.d_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert <span class="math">\(d\)</span> to <span class="math">\(q\)</span>.
The point of this function is to prevent fat-fingered typos.</p>
<p>By definition the relationship is:</p>
<p>..math</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">2</span> \<span class="n">pi</span><span class="p">}{</span><span class="n">q</span><span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>d</strong> : array</p>
<blockquote>
<div><p>An array of d (plane) spacing</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>q</strong> : array</p>
<blockquote class="last">
<div><p>An array of q values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.q_to_twotheta">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">q_to_twotheta</code><span class="sig-paren">(</span><em>q</em>, <em>wavelength</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.q_to_twotheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert q to two-theta.</p>
<p>By definition the relationship is:</p>
<p>..math</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>\<span class="n">sin</span>\<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span><span class="mi">2</span>\<span class="n">theta</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span> <span class="o">=</span> \<span class="n">frac</span><span class="p">{</span>\<span class="k">lambda</span> <span class="n">q</span><span class="p">}{</span><span class="mi">4</span> \<span class="n">pi</span><span class="p">}</span>
</pre></div>
</div>
<p>thus</p>
<p>..math</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">2</span>\<span class="n">theta_n</span> <span class="o">=</span> <span class="mi">2</span> \<span class="n">arcsin</span>\<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span>\<span class="k">lambda</span> <span class="n">q</span><span class="p">}{</span><span class="mi">4</span> \<span class="n">pi</span><span class="p">}</span>\<span class="n">right</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array</p>
<blockquote>
<div><p>An array of <span class="math">\(q\)</span> values</p>
</div></blockquote>
<p><strong>wavelength</strong> : float</p>
<blockquote>
<div><p>Wavelength of the incoming x-rays</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>two_theta</strong> : array</p>
<blockquote class="last">
<div><p>An array of <span class="math">\(2\theta\)</span> values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.twotheta_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">twotheta_to_q</code><span class="sig-paren">(</span><em>two_theta</em>, <em>wavelength</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.twotheta_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert two-theta to q</p>
<p>By definition the relationship is</p>
<p>..math</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>\<span class="n">sin</span>\<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span><span class="mi">2</span>\<span class="n">theta</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span> <span class="o">=</span> \<span class="n">frac</span><span class="p">{</span>\<span class="k">lambda</span> <span class="n">q</span><span class="p">}{</span><span class="mi">4</span> \<span class="n">pi</span><span class="p">}</span>
</pre></div>
</div>
<p>thus</p>
<p>..math</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">4</span> \<span class="n">pi</span> \<span class="n">sin</span>\<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span><span class="mi">2</span>\<span class="n">theta</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">right</span><span class="p">)}{</span>\<span class="k">lambda</span><span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>two_theta</strong> : array</p>
<blockquote>
<div><p>An array of <span class="math">\(2\theta\)</span> values</p>
</div></blockquote>
<p><strong>wavelength</strong> : float</p>
<blockquote>
<div><p>Wavelength of the incoming x-rays</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>q</strong> : array</p>
<blockquote class="last">
<div><p>An array of <span class="math">\(q\)</span> values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.angle_grid">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">angle_grid</code><span class="sig-paren">(</span><em>center</em>, <em>shape</em>, <em>pixel_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.angle_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a grid of angular positions.</p>
<p>Read note for our conventions here – there be dragons!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>center</strong> : tuple</p>
<blockquote>
<div><p>point in image where r=0; may be a float giving subpixel precision.
Order is (rr, cc).</p>
</div></blockquote>
<p><strong>shape: tuple</strong></p>
<blockquote>
<div><p>Image shape which is used to determine the maximum extent of output
pixel coordinates. Order is (rr, cc).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>agrid</strong> : array</p>
<blockquote class="last">
<div><p>angular position (in radians) of each array element in range [-pi, pi]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.radial_grid">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">radial_grid</code><span class="sig-paren">(</span><em>center</em>, <em>shape</em>, <em>pixel_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.radial_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a cartesian grid (x,y) to the radius relative to some center</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>center</strong> : tuple</p>
<blockquote>
<div><p>point in image where r=0; may be a float giving subpixel precision.
Order is (rr, cc).</p>
</div></blockquote>
<p><strong>shape</strong> : tuple</p>
<blockquote>
<div><p>Image shape which is used to determine the maximum extent of output
pixel coordinates.
Order is (rr, cc).</p>
</div></blockquote>
<p><strong>pixel_size</strong> : sequence, optional</p>
<blockquote>
<div><p>The physical size of the pixels.
len(pixel_size) should be the same as len(shape)
defaults to (1,1)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>r</strong> : array</p>
<blockquote class="last">
<div><p>The distance of each pixel from <cite>center</cite>
Shape of the return value is equal to the <cite>shape</cite> input parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.refine_center">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">refine_center</code><span class="sig-paren">(</span><em>image</em>, <em>calibrated_center</em>, <em>pixel_size</em>, <em>phi_steps</em>, <em>max_peaks</em>, <em>thresh</em>, <em>window_size</em>, <em>nx=None</em>, <em>min_x=None</em>, <em>max_x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.refine_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Refines the location of the center of the beam.</p>
<p>This relies on being able to see the whole powder pattern.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>image</strong> : ndarray</p>
<blockquote>
<div><p>The image</p>
</div></blockquote>
<p><strong>calibrated_center</strong> : tuple</p>
<blockquote>
<div><p>(row, column) the estimated center</p>
</div></blockquote>
<p><strong>pixel_size</strong> : tuple</p>
<blockquote>
<div><p>(pixel_height, pixel_width)</p>
</div></blockquote>
<p><strong>phi_steps</strong> : int</p>
<blockquote>
<div><p>How many regions to split the ring into, should be &gt;10</p>
</div></blockquote>
<p><strong>max_peaks</strong> : int</p>
<blockquote>
<div><p>Number of rings to look it</p>
</div></blockquote>
<p><strong>thresh</strong> : float</p>
<blockquote>
<div><p>Fraction of maximum peak height</p>
</div></blockquote>
<p><strong>window_size</strong> : int, optional</p>
<blockquote>
<div><p>The window size to use (in bins) to use when refining peaks</p>
</div></blockquote>
<p><strong>nx</strong> : int, optional</p>
<blockquote>
<div><p>Number of bins to use for radial binning</p>
</div></blockquote>
<p><strong>min_x</strong> : float, optional</p>
<blockquote>
<div><p>The minimum radius to use for radial binning</p>
</div></blockquote>
<p><strong>max_x</strong> : float, optional</p>
<blockquote>
<div><p>The maximum radius to use for radial binning</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>calibrated_center</strong> : tuple</p>
<blockquote class="last">
<div><p>The refined calibrated center.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.estimate_d_blind">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">estimate_d_blind</code><span class="sig-paren">(</span><em>name</em>, <em>wavelength</em>, <em>bin_centers</em>, <em>ring_average</em>, <em>window_size</em>, <em>max_peak_count</em>, <em>thresh</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.estimate_d_blind" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the sample-detector distance</p>
<p>Given a radially integrated calibration image return an estimate for
the sample-detector distance.  This function does not require a
rough estimate of what d should be.</p>
<p>For the peaks found the detector-sample distance is estimated via</p>
<div class="math">
\[D = \frac{r}{\tan 2\theta}\]</div>
<p>where <span class="math">\(r\)</span> is the distance in mm from the calibrated center
to the ring on the detector and <span class="math">\(D\)</span> is the distance from
the sample to the detector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<blockquote>
<div><p>The name of the calibration standard.  Used to look up the
expected peak location</p>
<p>Valid options: [‘Al2O3’, ‘CeO2’, ‘LaB6’, ‘Ni’, ‘Si’]</p>
</div></blockquote>
<p><strong>wavelength</strong> : float</p>
<blockquote>
<div><p>The wavelength of scattered x-ray in nm</p>
</div></blockquote>
<p><strong>bin_centers</strong> : array</p>
<blockquote>
<div><p>The distance from the calibrated center to the center of
the ring’s annulus in mm</p>
</div></blockquote>
<p><strong>ring_average</strong> : array</p>
<blockquote>
<div><p>The average intensity in the given ring of a azimuthally integrated
powder pattern.  In counts [arb]</p>
</div></blockquote>
<p><strong>window_size</strong> : int</p>
<blockquote>
<div><p>The number of elements on either side of a local maximum to
use for locating and refining peaks.  Candidates are identified
as a relative maximum in a window sized (2*window_size + 1) and
the same window is used for fitting the peaks to refine the location.</p>
</div></blockquote>
<p><strong>max_peak_count</strong> : int</p>
<blockquote>
<div><p>Use at most this many peaks</p>
</div></blockquote>
<p><strong>thresh</strong> : float</p>
<blockquote>
<div><p>Fraction of maximum peak height</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dist_sample</strong> : float</p>
<blockquote>
<div><p>The detector-sample distance in mm.  This is the mean of the estimate
from all of the peaks used.</p>
</div></blockquote>
<p><strong>std_dist_sample</strong> : float</p>
<blockquote class="last">
<div><p>The standard deviation of d computed from the peaks used.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Complete Reference (API)</a><ul>
      <li>Previous: <a href="core/mask.html" title="previous chapter"><code class="docutils literal"><span class="pre">core.mask</span></code> Module</a></li>
      <li>Next: <a href="fluorescence.html" title="next chapter"><code class="docutils literal"><span class="pre">fluorescence</span></code> Module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/resource/api/diffraction.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014-2015 Brookhaven National Lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/resource/api/diffraction.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>